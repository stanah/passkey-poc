# Rundler ERC-4337 Bundler Docker Compose Configuration
# Self-hosted bundler for Account Abstraction
#
# SETUP:
# 1. Clone Rundler repository:
#    git clone https://github.com/alchemyplatform/rundler.git
#    cd rundler
#    git submodule update --init --recursive
#
# 2. Build the Docker image:
#    docker buildx build . -t rundler
#
# 3. Return to this project and run:
#    docker compose up -d rundler

services:
  rundler:
    image: rundler
    command: node
    ports:
      # RPC port
      - "3000:3000"
      # Metrics port
      - "8080:8080"
    environment:
      - RUST_LOG=INFO
      - NETWORK=ethereum_sepolia
      - NODE_HTTP=${TENDERLY_RPC_URL}
      - SIGNER_PRIVATE_KEYS=${BUNDLER_PRIVATE_KEY}
      - DISABLE_ENTRY_POINT_V0_6=true
      # CORS configuration for frontend access
      - RPC_CORSDOMAIN=*
      # Skip debug_traceCall (not supported by Tenderly)
      - UNSAFE=true
      # Handle rate limiting from Tenderly
      - PROVIDER_RATE_LIMIT_RETRY_ENABLED=true
    restart: unless-stopped
